(()=>{"use strict";const e=window.wc.blocksCheckout,t=window.React,a=window.wp.element,o=window.wp.i18n,n=window.wp.data,{ExperimentalOrderMeta:l}=wc.blocksCheckout;function c({handleDeliveryPointChange:e,apaczkaPlDeliveryPoint:a}){return(0,t.createElement)("div",{className:"apaczka-delivery-point-wrap",style:{display:"none"}},(0,t.createElement)("input",{value:a,type:"text",id:"apaczka-point",onChange:e,required:!0}))}const i=JSON.parse('{"apiVersion":2,"name":"apaczka-pl/block","version":"1.0.0","title":"Apaczka PL Map Button","category":"woocommerce","description":"This code adds map button and adds input to save delivery point data.","supports":{"html":false,"align":false,"multiple":false,"reusable":false},"parent":["woocommerce/checkout-shipping-methods-block"],"attributes":{"lock":{"type":"object","default":{"remove":true,"move":true}},"text":{"type":"string","source":"html","selector":".wp-block-apaczka-pl","default":""}},"textdomain":"apaczka-pl","editorStyle":""}');(0,e.registerCheckoutBlock)({metadata:i,component:({checkoutExtensionData:e,extensions:i})=>{let s=!1,r=null;const[p,d]=(0,a.useState)(""),{setExtensionData:u}=e,m="apaczka-pl-delivery-point-error",{setValidationErrors:k,clearValidationError:h}=(0,n.useDispatch)("wc/store/validation");let g=(0,n.useSelect)((e=>e("wc/store/cart").getShippingRates()));const[w,_]=(0,a.useState)(!1),f=(0,n.useSelect)((e=>e("wc/store/checkout").prefersCollection()),[]);if((0,a.useEffect)((()=>{_(f)}),[f]),(0,a.useEffect)((()=>{const e=()=>{const e=document.getElementById("shipping-method");if(!e)return;const t=e.querySelectorAll(".wc-block-checkout__shipping-method-option"),a=e.querySelector(".wc-block-checkout__shipping-method-option--selected");if(a&&t.length>0){const e=Array.from(t).indexOf(a),o=1===e;console.log("Selected shipping method index:",e),console.log("isPickup shipping method:",o),o&&h(m),_(o)}};e();const t=document.getElementById("shipping-method");if(t){t.addEventListener("click",(t=>{setTimeout(e,100)}));const a=new MutationObserver((()=>{e()}));return a.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]}),()=>{a.disconnect()}}}),[]),null!=g){let e=g[Object.keys(g)[0]];if(null!=e&&e.hasOwnProperty("shipping_rates")){const t=e.shipping_rates,a=[],o=window.apaczka_block&&window.apaczka_block.map_config?window.apaczka_block.map_config:[];if(null!=t){for(let e of t)if("pickup_location"!==e.method_id){if(!0===e.selected){r=e.instance_id,e.method_id,null!=o[r]&&(s=!0)}a.push(e)}if(!r&&a.length>0){const e=document.getElementsByClassName("wc-block-components-shipping-rates-control")[0];if(null!=e){const t=e.querySelector('input[name^="radio-control-"]:checked');if(null!=t){let e=t.getAttribute("id");if(null!=e){let t=e.split(":");r=t[t.length-1],t[0],null!=o[r]&&(s=!0)}}}}}}}return(0,a.useEffect)((()=>{u("apaczka_pl","apaczka-point",p),p||!s||w?h(m):k({[m]:{message:(0,o.__)("Parcel locker must be choosen.","apaczka-pl"),hidden:!0}})}),[p,w,s,u,h,k]),(0,t.createElement)(t.Fragment,null,s&&!w&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("button",{className:"button alt apaczka_pl_geowidget_block",id:"apaczka_pl_geowidget_block"},(0,o.__)("Select point","apaczka-pl")),(0,t.createElement)("div",{id:"apaczka_selected_point_data_wrap",className:"apaczka_selected_point_data_wrap",style:{display:"none"}}),(0,t.createElement)(l,null,(0,t.createElement)(c,{apaczkaPlDeliveryPoint:p,handleDeliveryPointChange:e=>{const t=e.target.value;d(t)}}))))}})})();